{% extends "base.html" %}
{% block title %}Submit{% endblock %}
{% block content %}
    <br>
    <label for="form_select">Select reference type:</label>
    <select id="form_select" onchange="switchForm(this.value)">
        <option value="article" {% if last_ref_type == "article" %}selected{% endif %}>Article</option>
        <option value="book" {% if last_ref_type == "book" %}selected{% endif %}>Book</option>
        <!-- <option value="booklet">Booklet</option> -->
        <!-- <option value="conference">Conference</option> -->
        <!-- <option value="inbook">Inbook</option> -->
        <!-- <option value="incollection">Incollection</option> -->
        <option value="inproceedings" {% if last_ref_type == "inproceedings" %}selected{% endif %}>Inproceedings</option>
        <!-- <option value="manual">Manual</option> -->
        <!-- <option value="mastersthesis">Mastersthesis</option> -->
        <!-- <option value="misc">Misc</option> -->
        <!-- <option value="phdthesis">Phdthesis</option> -->
        <!-- <option value="proceedings">Proceedings</option> -->
        <!-- <option value="techreport">Techreport</option> -->
        <!-- <option value="unpublished">Unpublished</option> -->
    </select>

    {% include 'forms_handler.html' %}

    <script>
        function disableFormFields(form_fields, disable) {
                for (var i = 0; i < form_fields.length; i++) {
                    form_fields[i].disabled = disable;
                }
                form_select.disabled = disable;
            }
        function switchForm(selectedForm) {
            var forms = ['article', 'book', 'inproceedings'];
            /* Final version: var forms = ['article', 'book', 'booklet', 'conference', 'inbook', 
            'incollection', 'inproceedings', 'manual', 'mastersthesis', 'misc', 'phdthesis', 
            'proceedings', 'techreport', 'unpublished']; */
            forms.forEach(function(formId) {
                formDoc = document.getElementById(formId);
                formDoc.style.display = 'none';
                disableFormFields(formDoc.children[0].elements, true)
            });
                activeFormDoc = document.getElementById(selectedForm);
                activeFormDoc.style.display = 'block';
                disableFormFields(activeFormDoc.children[0].elements, false);
        }

        window.onload = function() {
            var form_select = document.getElementById("form_select");
            switchForm(form_select.value);

            var submit_button = document.getElementsByClassName("submit-button")[0];
            var form_fields = document.getElementsByClassName("form-field");
            var form = document.forms[0];



            {% if submitted %}
                disableFormFields(form_fields, true);
            {% else %}
                disableFormFields(form_fields, false);
            {% endif %}

            submit_button.onclick = function() {
                if (submitted) {
                    disableFormFields(form_fields, true);
                } else {
                    form.submit();
                }
            };
        };
    </script>
{% endblock %}