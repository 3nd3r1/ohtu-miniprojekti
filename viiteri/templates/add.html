{% extends "base.html" %}
{% block title %}Submit{% endblock %}
{% block content %}
    <p>Fill fields with DOI</p>
    <form id="doi-form">
        <input name="doi_fill" placeholder="DOI">
        <input type="submit" value="Fill">
    </form>
    <br>
    <label for="form_select">Select reference type:</label>
    <select id="form_select" onchange="switchForm(this.value)">
        <option value="article" {% if last_ref_type == "article" %}selected{% endif %}>Article</option>
        <option value="book" {% if last_ref_type == "book" %}selected{% endif %}>Book</option>
        <option value="inproceedings" {% if last_ref_type == "inproceedings" %}selected{% endif %}>Inproceedings</option>
    </select>

    {% include 'forms/article_submit_form.html' %}
    {% include 'forms/book_submit_form.html' %}
    {% include 'forms/inproceedings_submit_form.html' %}

    <script>
        function disableFormFields(form_fields, disable) {
                for (var i = 0; i < form_fields.length; i++) {
                    form_fields[i].disabled = disable;
                }
                form_select.disabled = disable;
            }
        function switchForm(selectedForm) {
            var forms = ['article', 'book', 'inproceedings'];

            forms.forEach(function(formId) {
                formDoc = document.getElementById(formId);
                formDoc.style.display = 'none';
                disableFormFields(formDoc.children[0].elements, true)
            });
                activeFormDoc = document.getElementById(selectedForm);
                activeFormDoc.style.display = 'block';
                disableFormFields(activeFormDoc.children[0].elements, false);
        }

        window.onload = function() {
            var form_select = document.getElementById("form_select");
            switchForm(form_select.value);

            var submit_button = document.getElementsByClassName("submit-button")[0];
            var form_fields = document.getElementsByClassName("form-field");
            var form = document.forms[0];

        };
    </script>
{% endblock %}